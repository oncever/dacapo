<project name="jython" default="all" basedir="..">
    <description>DaCapo jython benchmark</description>
    
	<property file="ant/dacapo.properties"/>
	
	<property name="bm-name" value="jython"/>
    <property name="bm-version" value="2.2.1"/>
    <property name="bm-url" value="${sourceforge.dl.url}/jython"/>
	<property name="bm-src" value="${bm-name}_installer-${bm-version}.jar"/>
	
    <import file="../common.xml"/>
	<import file="pybench.xml"/>
	
	<target name="source" depends="common.source, py-source"/>

	<target name="benchmark" depends="bm-unzip, bm-patch, bm-build, bm-jar, bm-data"/>
	
	<target name="bm-build" depends="bm-patch">
        <copy todir="${bm-build-dir}/src/java">
            <fileset file="${bm-build-dir}/build.*"/>
        </copy>
        <ant antfile="build.xml" dir="${bm-build-dir}/src/java" inheritall="false">
            <property name="javaccHome2" location="${javacchome}"/>
            <property name="python.lib" location="${bm-build-dir}/Lib"/>
        </ant>
	</target>

	<target name="bm-jar" depends="deps">
        <copy file="${bm-build-dir}/src/java/dist/jython.jar" todir="${jars}"/>
	</target>
	
	<target name="bm-data" depends="pybench">
 		<zip destfile="${zipdata}/jython.zip">
        	<fileset dir="${data}/" includes="jython/noop.py"/>
            <fileset dir="${data}/" includes="jython/sieve.py"/>
            <fileset dir="${bm-build-dir}/" includes="jython/pybench/**"/>
            <fileset dir="${bm-build-dir}/" includes="jython/Lib/**"/>
        </zip>
	</target>

	<target name="deps">
    	<copy file="${build.src}/ant/ant.jar" todir="${build.deps}"/>
    	<copy file="${build.src}/ant/ant-launcher.jar" todir="${build.deps}"/>
	</target>
</project>
